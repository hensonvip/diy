<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimal-ui" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="format-detection" content="telephone=no, email=no" />
<link href="__CSSPC__/style.css" type="text/css" rel="stylesheet" />
<link href="__CSSPC__/jquery.mCustomScrollbar.css" type="text/css" rel="stylesheet" />
<title>{$site_title}</title>
<meta name="keywords" content="{$site_keywords}">
<meta name="description" content="{$site_description}">
</head>
<body>
<!--header start-->
<div class="header first second fixed">
    {include file="public/nav" /}
    {include file="public/user_right" /}
</div>
<div class="float_right"></div>
<!--header end-->
<!--main start-->
<div class="mem_main bg_f5f5f5 clearfix">
	{include file="public/user_left" /}
	<div class="mem_right">
		<div class="mem_rtit">账户安全</div>
		<div class="mem_rcon safe_rcon">
			<div class="safe_grade">
				<h2>安全级别</h2>
				<p>建议开启全部安全设置，以保障账户及资金安全</p>
				<div class="type">
					<span>一般</span>
					<div class="bar type1"><i></i></div>
				</div>
			</div>
			<ul class="safe_list">
				<li class="show_link smrz {if $user.is_renzheng eq 1}on{/if}">
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>实名认证</h2>
							<p>根据《互联网用户账号名称管理规定》，用户需进行实名认证才能发布相关内容</p>
						</div>
					</div>
					<div class="right"><a href="{:url('User/renzheng')}" class="btn nb_t1 show_form">{if $user.is_renzheng eq 0}点击认证{else /}重新验证{/if}</a></div>
				</li>
				<li class="show_link on">
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>登陆密码</h2>
							<p>互联网账号存在被盗风险，建议您定期更改密码以保护账户安全</p>
						</div>
					</div>
					<div class="right"><a href="{:url('User/pwd')}" class="edit"></a></div>
				</li>
				<li class="show_link on">
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>手机修改</h2>
							<p>手机可用于快速找回登录密码，接收消息提醒</p>
						</div>
					</div>
					<div class="right"><a href="{:url('User/edit_mobile')}" class="edit"></a></div>
				</li>
				<li {if $user.email}class="on"{/if}>
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>邮箱绑定</h2>
							<p>绑定后，可用于快速找回登录密码，接收消息提醒</p>
						</div>
					</div>
					<div class="right">
						<form action="" class="safe_form">
							<input type="text" placeholder="请输入要绑定的邮箱" class="safe_form_input email_input">
							<input type="button" value="发送验证邮件" class="safe_form_sub email_sub">
						</form>
                        {if $user.email}
                        <div class="right"><a href="{:url('User/edit_email')}" class="edit"></a></div>
                        {else /}
                        <span class="btn nb_t1 show_form">邮箱绑定</span>
                        {/if}
						<!-- <span class="btn nb_t1 show_form">邮箱绑定</span>
                        <span class="btn nb_t3">解除绑定</span> -->
					</div>
				</li>
				<li>
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>微信绑定</h2>
							<p>互联网账号存在被盗风险，建议您定期更改密码以保护账户安全</p>
						</div>
					</div>
					<div class="right">
						<form action="" class="safe_form">
							<input type="text" placeholder="请输入绑定微信" class="safe_form_input">
							<input type="submit" value="确 定" class="safe_form_sub">
						</form>
						<span class="btn nb_t1 show_form">微信绑定</span>
						<span class="btn nb_t3">解除绑定</span>
					</div>
				</li>
				<li>
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>QQ绑定</h2>
						</div>
					</div>
					<div class="right">
						<a href="" class="btn nb_t1 show_form">QQ绑定</a>
						<!-- <span class="btn nb_t3">解除绑定</span> -->
					</div>
				</li>
				<li class="on">
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>微博绑定</h2>
							<p>kdjfd@weibo.com</p>
						</div>
					</div>
					<div class="right">
						<a href="" class="btn nb_t1 show_form">微博绑定</a>
						<span class="btn nb_t3">解除绑定</span>
					</div>
				</li>
				<li class="on">
					<div class="left">
						<i class="state"></i>
						<div class="text">
							<h2>支付宝绑定</h2>
							<p>13455419654</p>
						</div>
					</div>
					<div class="right">
						<form action="" class="safe_form">
							<input type="text" placeholder="请输入绑定支付宝" class="safe_form_input">
							<input type="submit" value="确 定" class="safe_form_sub">
						</form>
						<span class="btn nb_t1 show_form">支付宝绑定</span>
						<span class="btn nb_t3">解除绑定</span>
					</div>
				</li>
			</ul>
		</div>
	</div>
</div>
<!--main end-->
<!--footer start-->
{include file="public/footer" /}
<!--footer end-->
</body>
</html>
<script src="__JSPC__/jquery.js"></script>
<script src="__JSPC__/ifie8.js"></script>
<script src="__JSPC__/lazybg.js"></script>
<script src="__JSPC__/layer.js"></script>
<script src="__JSPC__/js.js"></script>
<script src="__JSPC__/slick.js"></script>
<script src="__JSPC__/selectordie.min.js"></script>
<script src="__JSPC__/jquery.placeholder.min.js"></script>
<script src="__JSPC__/jquery.dotdotdot.min.js"></script>
<script src="__JSPC__/jquery.mCustomScrollbar.concat.min.js"></script>
<script>
$(function(){
	//删除
	$('.not_rm_del').click(function() {
		var _this = $(this);
		layer.confirm('确定删除该聊天记录？', {
			title: false,
			closeBtn: 0,
			btn: ['取 消','确 定'] //按钮
		}, function(){
			layer.closeAll();
		}, function(){
			window.history.go(-1);
		});
	});

	//编辑
	$('.show_form').click(function() {
		$(this).parents('li').addClass('active');
	});

	$('.email_sub').click(function() {
		var email_input = $('.email_input').val();
		var isEmail = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
		if(email_input == ""){
            layer.tips('请输入邮箱', '.email_input', {
              tips: 3,
              time: 2000
            });
            return false;
        }else if(!(isEmail.test(email_input))){
			layer.tips('请输入正确的邮箱', '.email_input', {
              tips: 3,
              time: 2000
            });
            return false;
        }else{
            $.ajax({
               type: "post",
               url: "{:url('User/send_bind_email')}",
               dataType: 'json',
               data:{email:email_input},
               beforeSend: function(){
                    layer.msg('邮件发送中，请耐心等待...');
               },
               success: function(data){
                    if (data.code == 200) {
                        layer.open({
                            content: data.message,
                            btn: '确定',
                            shadeClose: false,
                            yes: function(index){
                                layer.close(index);
                            }
                        });

                        $('.email_sub').val("60s").addClass('counting');
                        var second = 60;
                        var timer = null;
                        timer = setInterval(function(){
                            second -= 1;
                            if(second >0 ){
                                $('.email_sub').val(second+"s")
                                $('.email_sub').addClass('counting');
                            }else{
                                clearInterval(timer);
                                $('.email_sub').removeClass('counting');
                                $('.email_sub').val("重新获取")
                            }
                        },1000);
                    } else {
                        layer.open({
                            content: data.message,
                            btn: '确定',
                            shadeClose: false,
                            yes: function(index){
                                layer.close(index);
                            }
                        });
                    }
               }
            });
		}
	});
});
</script>

